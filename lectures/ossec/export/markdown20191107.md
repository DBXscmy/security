# 操作系统安全概述

--- 

##  1 什么是操作系统？

操作系统是一种软件，管理着计算机硬件和软件资源，为计算机程序提供基础、通用的服务。

![250px-Operating_system_placement](images/01/250px-Operating_system_placement.svg.png)

##  2 操作系统的分类

OS类型非常多，通常我们从以下方面对其进行分类：
- 单、多任务
- 单、多用户
- 分布式
- 模板式（例如虚拟化的）
- 嵌入式
- 实时型

具体地，常见OS有：

- Unix 或类Unix系统
- BSD 及其后代
- MacOS
- Linux
- Microsoft Windows
- Other

##  3 操作系统的组成

###  3.1 内核（kernel）

操作系统中最基本的组件，负责管理内存、访问硬件资源、设置计算机系统状态、组织数据输入输出。

内核程序位于特权模式下，可以执行任何资源的访问与控制，内核必须受到严格的保护。
# 目录

##  4 Linux的安全问题

1. 安全策略
2. 口令保护
3. 配置服务器安全
4. 校验介质完整性
5. 使用LUKS磁盘加密
6. 使用Nmap扫描linux
   
##  5 配置安全且优化Linux内核

##  6 本地文件系统安全

1. 访问控制列表
2. LDAP服务器配置

##  7 Linux本地认证

1. 用户认证和日志记录
2. 限制用户登录能力
3. 使用acct监视用户行为
4. 定义用户授权控制

##  8 Linux远程认证

1. 使用ssh登录
2. 禁止root登录ssh
3. 基于密钥加密ssh远程访问
4. 建立kerberos服务器

##  9 网络安全

1. 管理tcp/ip网络
2. 使用iptables
3. 阻止地址伪装
4. 拦截入站流量
5. 配置tcp wrapper

##  10 安全工具

1. Linux的sXid工具
2. PortSentry
3. Squid
4. OpenSSL
5. Tripwire
6. Shorewall

##  11 Linux安全发行版

1. kali linux
2. pfSense
3. DEFT
4. NST
5. Helix

##  12 修补bash漏洞

##  13 安全监控和日志

1. 使用Logcheck
2. 使用Glances监控系统
3. 使用MultiTail监控日志
4. 使用系统工具Whowatch
5. stat
6. lsof
7. strace
8. lynis

常见安全加固方法：
- 为操作系统运行供应商建议的最新补丁。
- 除去不重要的应用程序来减少可能的系统漏洞。将本地服务限制为操作所需的服务。
- 为缓冲区溢出实施保护。可能需要第三方软件来执行此操作。

###  13.1 进程

应用程序以进程方式（被操作系统管理）使用内存、访问硬件资源、完成计算。

进程的管理只能由内核程序负责，应用程序不应越权。

###  13.2 中断

中断是操作系统进行调度的主要机制，它是实现OS与环境（用户、程序、硬件）交互和反馈的便捷方式。

中断的优先级、中断的调用方式必须受到保护，不能被恶意程序肆意修改。

###  13.3 模型

现代微处理器支持多种操作模型，至少也支持两种模型：
- 用户模型
- 特权模型（内核模型）

更多的模型设置是为了以“知其所需、最小特权”为原则，来区分不同角色的特权。

![800px-Priv_rings](images/01/800px-Priv_rings.png)

###  13.4 内存管理

内存管理不仅影响着OS性能，也与OS安全息息相关。

某个应用程序越权访问其它应用程序所用内存、或非法访问OS内核内存都是要被严格禁止的。

下图显示了操作系统管理虚拟内存的模型：
![800px-Virtual_memory](images/01/800px-Virtual_memory.png)

###  13.5 磁盘访问和文件系统

OS负责IO数据设备的访问，管理文件格式（内容的存储形式）。

磁盘与文件系统的访问，必须建立在一致、严格的访问控制策略之下。

常见安全加固方法：
- 为用户授予所需目录的只读权限。
- 缺省情况下，拒绝访问权限。
- 除了被明确授予访问权限的用户，拒绝所有人对资源的访问。
- 可以拒绝所有用户对所有目录结构的读入和写入权限。仅被明确授予了这些权限的用户可访问目录和文件。此策略还会保护管理员忽略的任何资源。

###  13.6 设备驱动

不同的IO设备需要不同的驱动程序，这些程序应视为内核的一部分受到保护。

###  13.7 网络

基础网络服务程序也是内核的一部分。

常见安全加固策略：

- 在服务器计算机上提供所需的最小服务数。
- 仅使用运行应用程序所需的服务。每个服务都是恶意攻击的潜在入口点。减少正在运行的服务数也使系统更易管理。例如，可能不需要 ftp、rlogin 或 ssh 服务。
- 为网络服务用户减少访问权限的级别。避免网络服务对大众公开。
- 确保具有 Web 服务器访问权限的用户帐户不可访问 shell 功能。
- 确保 UNIX 和 Linux 操作系统上 /etc 目录内的 rc 文件（从 rc0 到 rc6）中不存在未使用的服务。
- 确保未使用的服务没有运行，且它们没有在 Microsoft Windows 操作系统上自动启动。
- 确保所需的服务正在 UNIX 上运行。
- 可以使用 ps 和 netstat 实用程序来查看正在运行的服务。ps 实用程序提供计算机上当前正在运行的进程的列表。netstat 实用程序提供当前正在使用的端口的列表。
- 减少在 /etc/services 文件中指定的信任端口数。
- 删除或注释掉未计划使用的端口，来减少系统的可能入口点。
- 保护系统免受与端口 137、138 和 139 相关联的 NetBIOS 威胁。Linux下可以使用/etc/services 文件中列出了这些端口。

- 使用防火墙程序服务，如 iptables。
通过经常检查安全性更新，确保服务是最新的。
避免使用具有图形用户界面 (GUI) 的服务（若可能）。但要注意，任何工具、服务可能会引入新的安全漏洞。

###  13.8 安全工具

用于支持OS实现访问控制、加密、网络入侵防护、日志、审计等功能。

常见安全加固方法：

密码策略方面：

- 开发和管理促进操作系统安全的密码策略。例如：高强度密码规则和密码更改计划。
- 在 UNIX 操作系统上，激活影子密码文件。在 UNIX 上，密码存储在 /etc/passwd 文件中。此文件对所有人开放，这会导致安全风险。要增强密码安全性，激活名为 /etc/shadow 的影子密码文件。如果此文件可用，那么密码会存储在其中，而非 passwd 文件。因为 /etc/shadow 文件的权限更加严格，因此安全风险更低。、

用户策略方面：

- 限制服务器计算机上的用户帐户数。不必要的和旧的用户帐户会增加系统复杂性，并导致系统漏洞。

- 确保仅一些可信用户具有对服务器计算机的管理访问权限。管理员越少，维护责任越容易。
- 任命的管理员必须胜任工作。
- 为运行应用程序的帐户分配所需的最低访问权限。

日志审计方面：

- 记录安全性相关的事件，包括成功和失败的登录、注销和用户权限的更改。
- 监视系统日志文件。
- 使用时间服务器来关联取证时间。
- 通过限制对系统日志文件的访问权限，保护其安全。
- 对于每日维护，日志很重要，且作为灾难恢复工具。因此，必须在系统失败时保护它们，并保护它们免受用户篡改。
- 使用 IPF 日志记录来构建更复杂的日志记录系统。
- 要增加日志文件系统的安全性，您可以将所有日志文件放在一个服务器上的一个位置，这会简化日志文件的管理。为冗余设置多个日志记录服务器将远程服务器用于日志记录如果系统受到危害（如硬盘驱动损坏）。

- 保护日志记录配置文件的安全。配置文件包含在更改时可危害日志系统可靠性的设置。例如，错误设置日志级别可导致不记录某些失败。

- 在 Web 服务器上启用访问请求的日志记录。这在识别恶意活动时很有用。

备份策略方面：
- 从已知的可重复进程构建生产系统，以确保系统完整性。
- 定期针对原始系统的快照检查系统。
- 使用可用的第三方审核软件来检查系统完整性。
- 定期备份系统资源。

###  13.9 用户界面

##  14 OS种常见的安全技术

无论何种主流OS，均采用了下面这些安全技术：
- 身份管理（区分用户角色）
- 访问权限管理（实现零信任管理）
- 威胁防护（防止破坏性攻击）
- 信息保护（对信息进行定位、分类、加密、签名、验证）
- 安全管理（优化安全管理方法）
